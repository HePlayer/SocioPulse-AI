<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocioPulse AI</title>
    
    <!-- CSSÊñá‰ª∂ -->
    <link rel="stylesheet" href="assets/css/themes.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
</head>
<body>
    <div class="container">
        <!-- È°∂ÈÉ®Ê†è -->
        <div class="top-bar">
            <div class="logo">SocioPulse AI</div>
            <div class="top-controls">
                <button class="icon-btn" id="settingsBtn" title="ËÆæÁΩÆ">‚öôÔ∏è</button>
                <button class="theme-toggle" title="ÂàáÊç¢‰∏ªÈ¢ò">üåô</button>
            </div>
        </div>

        <!-- ËÅäÂ§©ÂàóË°® -->
        <div class="chat-list" id="chatList">
            <div class="chat-list-header">
                <input type="text" class="search-input" placeholder="ÊêúÁ¥¢ËÅäÂ§©...">
                <button class="add-chat-btn" title="Êñ∞Âª∫ËÅäÂ§©">+</button>
            </div>
            <div class="chat-items" id="chatItems">
                <!-- ËÅäÂ§©È°πÁõÆÂ∞ÜÂä®ÊÄÅÊ∑ªÂä† -->
            </div>
        </div>

        <!-- ËÅäÂ§©Âå∫Âüü -->
        <div class="chat-area" id="chatArea">
            <!-- ËÅäÂ§©Â§¥ÈÉ® -->
            <div class="chat-header" id="chatHeader" style="display: none;">
                <div class="chat-header-info">
                    <div class="chat-avatar">A</div>
                    <div>
                        <div class="chat-name" id="chatHeaderName">Á§∫‰æãËÅäÂ§©</div>
                        <div class="chat-preview" id="chatHeaderStatus">Âú®Á∫ø</div>
                    </div>
                </div>
                <div class="chat-header-actions">
                    <button class="icon-btn" id="agentInfoBtn" title="Agent‰ø°ÊÅØ">üë§</button>
                    <button class="icon-btn" id="moreOptionsBtn" title="Êõ¥Â§öÈÄâÈ°π">‚ãÆ</button>
                </div>
            </div>
            
            <!-- Ê∂àÊÅØÂÆπÂô® -->
            <div class="messages-container" id="messagesContainer" style="display: none;">
                <!-- Ê∂àÊÅØÂ∞ÜÂä®ÊÄÅÊ∑ªÂä†Âà∞ËøôÈáå -->
            </div>
            
            <!-- ËæìÂÖ•Âå∫Âüü -->
            <div class="input-container" id="inputContainer" style="display: none;">
                <div class="input-wrapper">
                    <textarea class="message-input" id="messageInput" placeholder="ËæìÂÖ•Ê∂àÊÅØ..." rows="1"></textarea>
                    <button class="send-btn" id="sendBtn" title="ÂèëÈÄÅ">üì§</button>
                </div>
            </div>
            
            <!-- ÈªòËÆ§Á©∫Áä∂ÊÄÅ - Áªü‰∏ÄÁ≤æÁæéÊ¨¢ËøéÁïåÈù¢ -->
            <div class="empty-state" id="emptyState">
                <div class="initial-welcome-container">
                    <div class="welcome-content">
                        <div class="welcome-icon">üí¨</div>
                        <h2>Ê¨¢Ëøé‰ΩøÁî® SocioPulse AI</h2>
                        <p>ÊÇ®ËøòÊ≤°ÊúâÂàõÂª∫‰ªª‰ΩïËÅäÂ§©ÂÆ§</p>
                        <p>ÁÇπÂáªÂ∑¶‰æßÁöÑ"+"ÊåâÈíÆÂºÄÂßãÊÇ®ÁöÑÁ¨¨‰∏ÄÊ¨°ÂØπËØù</p>
                        <button class="welcome-create-btn" onclick="window.chatManager?.showCreateRoomModal()">
                            <span class="btn-icon">‚ûï</span>
                            ÂàõÂª∫Á¨¨‰∏Ä‰∏™ËÅäÂ§©ÂÆ§
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Â∑•‰ΩúÂå∫ -->
        <div class="workspace" id="workspace">
            <div class="workspace-header">
                <h2>Â∑•‰ΩúÂå∫</h2>
                <button class="icon-btn" id="backToChat">ËøîÂõûËÅäÂ§©</button>
            </div>
            <div class="workspace-content" id="workspaceContent">
                <!-- Â∑•‰ΩúÂå∫ÂÜÖÂÆπ -->
            </div>
        </div>

        <!-- Agent‰ø°ÊÅØÊ®°ÊÄÅÊ°Ü -->
        <div class="modal-overlay" id="agentInfoModal" style="display: none;">
            <div class="agent-info-modal">
                <div class="modal-header">
                    <h3>Agent‰ø°ÊÅØÁÆ°ÁêÜ</h3>
                    <button class="close-btn" id="closeAgentInfoModal">√ó</button>
                </div>
                <div class="modal-body" id="agentInfoContent">
                    <!-- Agent‰ø°ÊÅØÂÜÖÂÆπÂ∞ÜÂä®ÊÄÅÂä†ËΩΩ -->
                    <div class="loading-placeholder">
                        <div class="loading-spinner"></div>
                        <p>Âä†ËΩΩAgent‰ø°ÊÅØ‰∏≠...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="action-btn" id="addNewAgentBtn">Ê∑ªÂä†Agent</button>
                    <button class="cancel-btn" id="closeAgentInfoBtn">ÂÖ≥Èó≠</button>
                </div>
            </div>
        </div>

        <!-- Êõ¥Â§öÈÄâÈ°π‰∏ãÊãâËèúÂçï -->
        <div class="dropdown-overlay" id="moreOptionsDropdown" style="display: none;">
            <div class="dropdown-menu" id="moreOptionsMenu">
                <!-- Êõ¥Â§öÈÄâÈ°πËèúÂçïÈ°πÂ∞ÜÂä®ÊÄÅÁîüÊàê -->
            </div>
        </div>

        <!-- ËÆæÁΩÆÊ®°ÊÄÅÊ°Ü -->
        <div class="modal-overlay" id="settingsModal" style="display: none;">
            <div class="settings-modal">
                <div class="modal-header">
                    <h3>Á≥ªÁªüËÆæÁΩÆ</h3>
                    <button class="close-btn" id="closeSettingsModal">√ó</button>
                </div>
                
                <div class="modal-body">
                    <div class="settings-tabs">
                        <button class="tab-btn active" data-tab="models">Ê®°ÂûãÈÖçÁΩÆ</button>
                        <button class="tab-btn" data-tab="features">ÂäüËÉΩËÆæÁΩÆ</button>
                        <button class="tab-btn" data-tab="data">Êï∞ÊçÆÁÆ°ÁêÜ</button>
                    </div>
                    
                    <!-- Ê®°ÂûãÈÖçÁΩÆÊ†áÁ≠æÈ°µ -->
                    <div class="tab-content active" id="modelsTab">
                        <div class="setting-section">
                            <h4>ÈªòËÆ§Âπ≥Âè∞</h4>
                            <select id="defaultPlatformSelect">
                                <option value="aihubmix">AiHubMix</option>
                                <option value="openai">OpenAI</option>
                                <option value="zhipuai">Êô∫Ë∞±AI</option>
                            </select>
                        </div>
                        
                        <div class="platform-configs">
                            <!-- OpenAIÈÖçÁΩÆ -->
                            <div class="platform-config" data-platform="openai">
                                <h4>OpenAI ÈÖçÁΩÆ</h4>
                                <div class="config-row">
                                    <label>API Key:</label>
                                    <input type="password" id="openaiApiKey" placeholder="sk-...">
                                    <button class="test-btn" data-platform="openai">ÊµãËØï</button>
                                </div>
                                <div class="config-row">
                                    <label>API Base:</label>
                                    <input type="text" id="openaiApiBase" value="https://api.openai.com/v1">
                                </div>
                                <div class="config-row">
                                    <label>ÂèØÁî®Ê®°Âûã:</label>
                                    <div class="model-checkboxes" id="openaiModels">
                                        <label><input type="checkbox" value="gpt-4" checked> GPT-4</label>
                                        <label><input type="checkbox" value="gpt-4-turbo"> GPT-4 Turbo</label>
                                        <label><input type="checkbox" value="gpt-3.5-turbo"> GPT-3.5 Turbo</label>
                                    </div>
                                </div>
                                <div class="config-row">
                                    <label>ÈªòËÆ§Ê®°Âûã:</label>
                                    <select id="openaiDefaultModel">
                                        <option value="gpt-4">GPT-4</option>
                                        <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                        <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- AiHubMixÈÖçÁΩÆ -->
                            <div class="platform-config" data-platform="aihubmix">
                                <h4>AiHubMix ÈÖçÁΩÆ</h4>
                                <div class="config-row">
                                    <label>API Key:</label>
                                    <input type="password" id="aihubmixApiKey" placeholder="ËæìÂÖ•API Key">
                                    <button class="test-btn" data-platform="aihubmix">ÊµãËØï</button>
                                </div>
                                <div class="config-row">
                                    <label>API Base:</label>
                                    <input type="text" id="aihubmixApiBase" value="https://aihubmix.com/v1">
                                </div>
                                <div class="config-row">
                                    <label>ÂèØÁî®Ê®°Âûã:</label>
                                    <div class="model-checkboxes" id="aihubmixModels">
                                        <label><input type="checkbox" value="gpt-4o-mini" checked> GPT-4o Mini</label>
                                        <label><input type="checkbox" value="gpt-4o-search-preview"> GPT-4o Search Preview</label>
                                        <label><input type="checkbox" value="gpt-4o-mini-search-preview"> GPT-4o Mini Search Preview</label>
                                    </div>
                                </div>
                                <div class="config-row">
                                    <label>ÈªòËÆ§Ê®°Âûã:</label>
                                    <select id="aihubmixDefaultModel">
                                        <option value="gpt-4o-mini">GPT-4o Mini</option>
                                        <option value="gpt-4o-search-preview">GPT-4o Search Preview</option>
                                        <option value="gpt-4o-mini-search-preview">GPT-4o Mini Search Preview</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Êô∫Ë∞±AIÈÖçÁΩÆ -->
                            <div class="platform-config" data-platform="zhipu">
                                <h4>Êô∫Ë∞±AI ÈÖçÁΩÆ</h4>
                                <div class="config-row">
                                    <label>API Key:</label>
                                    <input type="password" id="zhipuaiApiKey" placeholder="ËæìÂÖ•API Key">
                                    <button class="test-btn" data-platform="zhipuai">ÊµãËØï</button>
                                </div>
                                <div class="config-row">
                                    <label>API Base:</label>
                                    <input type="text" id="zhipuaiApiBase" value="https://open.bigmodel.cn/api/paas/v4">
                                </div>
                                <div class="config-row">
                                    <label>ÂèØÁî®Ê®°Âûã:</label>
                                    <div class="model-checkboxes" id="zhipuaiModels">
                                        <label><input type="checkbox" value="glm-4" checked> GLM-4</label>
                                        <label><input type="checkbox" value="glm-4-plus"> GLM-4 Plus</label>
                                        <label><input type="checkbox" value="glm-3-turbo"> GLM-3 Turbo</label>
                                    </div>
                                </div>
                                <div class="config-row">
                                    <label>ÈªòËÆ§Ê®°Âûã:</label>
                                    <select id="zhipuaiDefaultModel">
                                        <option value="glm-4">GLM-4</option>
                                        <option value="glm-4-plus">GLM-4 Plus</option>
                                        <option value="glm-3-turbo">GLM-3 Turbo</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂäüËÉΩËÆæÁΩÆÊ†áÁ≠æÈ°µ -->
                    <div class="tab-content" id="featuresTab">
                        <div class="setting-section">
                            <h4>Agent‰∏ªÂä®ËÅäÂ§©</h4>
                            <div class="config-row">
                                <label>ÂêØÁî®‰∏ªÂä®ËÅäÂ§©:</label>
                                <label class="switch">
                                    <input type="checkbox" id="proactiveChatEnabled">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="config-row">
                                <label>ÁõëÂê¨Èó¥Èöî (Áßí):</label>
                                <input type="range" id="monitoringInterval" min="1" max="60" value="5">
                                <span id="intervalValue">5</span>
                            </div>
                            <div class="config-row">
                                <label>ÁΩÆ‰ø°Â∫¶ÈòàÂÄº:</label>
                                <input type="range" id="confidenceThreshold" min="0.1" max="1.0" step="0.1" value="0.8">
                                <span id="confidenceValue">0.8</span>
                            </div>
                            <div class="config-row">
                                <label>ÊØèÂ∞èÊó∂ÊúÄÂ§ßÂª∫ËÆÆ:</label>
                                <input type="number" id="maxSuggestionsPerHour" min="1" max="20" value="3">
                            </div>
                        </div>
                        
                        <div class="setting-section">
                            <h4>ÁïåÈù¢ËÆæÁΩÆ</h4>
                            <div class="config-row">
                                <label>ÈªòËÆ§‰∏ªÈ¢ò:</label>
                                <select id="defaultTheme">
                                    <option value="light">ÊµÖËâ≤‰∏ªÈ¢ò</option>
                                    <option value="dark">Ê∑±Ëâ≤‰∏ªÈ¢ò</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Êï∞ÊçÆÁÆ°ÁêÜÊ†áÁ≠æÈ°µ -->
                    <div class="tab-content" id="dataTab">
                        <div class="setting-section">
                            <h4>ÈÖçÁΩÆÁÆ°ÁêÜ</h4>
                            <div class="config-row">
                                <button class="action-btn" id="exportConfigBtn">ÂØºÂá∫ÈÖçÁΩÆ</button>
                                <button class="action-btn" id="importConfigBtn">ÂØºÂÖ•ÈÖçÁΩÆ</button>
                                <input type="file" id="importConfigFile" accept=".json" style="display: none;">
                            </div>
                            <div class="config-row">
                                <button class="action-btn danger" id="resetSettingsBtn">ÈáçÁΩÆÊâÄÊúâËÆæÁΩÆ</button>
                            </div>
                        </div>
                        
                        <div class="setting-section">
                            <h4>Â≠òÂÇ®‰ø°ÊÅØ</h4>
                            <div class="storage-info">
                                <p>ÈÖçÁΩÆÂ≠òÂÇ®: <span id="storageSize">ËÆ°ÁÆó‰∏≠...</span></p>
                                <p>ÊúÄÂêéÊõ¥Êñ∞: <span id="lastUpdate">-</span></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button class="cancel-btn" id="cancelSettingsBtn">ÂèñÊ∂à</button>
                    <button class="create-btn" id="saveSettingsBtn">‰øùÂ≠òËÆæÁΩÆ</button>
                </div>
            </div>
        </div>

        <!-- AgentÈÖçÁΩÆÊ®°ÊÄÅÊ°Ü -->
        <div class="modal-overlay" id="agentConfigModal" style="display: none;">
            <div class="agent-config-modal">
                <div class="modal-header">
                    <h3>ÂàõÂª∫Êñ∞ËÅäÂ§©</h3>
                    <button class="close-btn" id="closeModal">√ó</button>
                </div>
                
                <div class="modal-body">
                    <div class="room-name-input">
                        <label>ËÅäÂ§©ÂÆ§ÂêçÁß∞Ôºö</label>
                        <input type="text" id="roomNameInput" placeholder="ËæìÂÖ•ËÅäÂ§©ÂÆ§ÂêçÁß∞...">
                    </div>
                    
                    <div class="chat-type-selector">
                        <label>ËÅäÂ§©Á±ªÂûãÔºö</label>
                        <select id="chatTypeSelect">
                            <option value="single">Âçï‰∏™AgentÂØπËØù</option>
                            <option value="group">Â§öAgentÁæ§ËÅä</option>
                        </select>
                    </div>
                    
                    <div class="agents-config" id="agentsConfig">
                        <!-- AgentÈÖçÁΩÆÈ°πÂ∞ÜÂä®ÊÄÅÊ∑ªÂä† -->
                    </div>
                    
                    <button class="add-agent-btn" id="addAgentBtn">+ Ê∑ªÂä†Agent</button>
                </div>
                
                <div class="modal-footer">
                    <button class="cancel-btn" id="cancelBtn">ÂèñÊ∂à</button>
                    <button class="create-btn" id="createRoomBtn">ÂàõÂª∫ËÅäÂ§©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Â≠òÂÇ®Á≥ªÁªüÊ®°Âùó -->
    <script src="assets/js/storage/event-bus.js"></script>
    <script src="assets/js/storage/data-models.js"></script>
    <script src="assets/js/storage/memory-cache.js"></script>
    <script src="assets/js/storage/localstorage-manager.js"></script>
    <script src="assets/js/storage/indexeddb-manager.js"></script>
    <script src="assets/js/storage/storage-manager.js"></script>
    
    <!-- JavaScriptÊñá‰ª∂ -->
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/modal_manager.js"></script>
    <script src="assets/js/websocket.js"></script>
    <script src="assets/js/settings.js"></script>
    <script src="assets/js/layout-manager.js"></script>
    <script src="assets/js/chat-room-actions.js"></script>
    <script src="assets/js/chat-manager.js"></script>
    <script src="assets/js/main.js"></script>
</body>
</html>
